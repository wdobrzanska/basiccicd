name: Ci_weather_app

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]

jobs: 
    build:
       name: Build and test
       runs-on: ubuntu-latest
       steps:
        - uses: actions/checkout@v3

        - name: Setup Node.js
          uses: actions/setup-node@v3
          with:
               node-version: '20'
               cache: 'npm'

        - name: Install dependencies
          run: npm ci

        - name: Build Aplication
          run: npm run build
        - name: Run tests with coverage
          run: npm run test:coverage
          continue-on-error: true

    docker:
        name: Docker Build and Test
        needs: build
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v3
      
        - name: Build Docker image
          run: docker build -t weather-app .   

